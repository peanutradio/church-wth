# 회원 관리 시스템 설정 가이드

## 📋 개요
교회 웹사이트 관리자 페이지에 고급 회원 관리 시스템이 추가되었습니다.

## ✨ 주요 기능
1. **통계 대시보드**: 전체/관리자/회원/게스트 통계
2. **회원 검색**: 이름 또는 이메일로 검색
3. **권한 관리**: 게스트 ↔ 회원 ↔ 관리자 변경
4. **필터링**: 권한별 필터
5. **페이지네이션**: 10명씩 페이지 나누기
6. **엑셀 다운로드**: 회원 명단 Excel 파일로 내보내기
7. **활동 로그**: 마지막 로그인 시간 추적

## 🔧 설정 방법

### 1단계: 데이터베이스 마이그레이션 실행

Supabase Dashboard에 접속하여 SQL Editor에서 다음 SQL을 실행하세요:

```sql
-- supabase/migrations/add_last_login.sql 파일 내용 복사해서 실행
```

또는 파일 위치: `/Users/lsports_chan/church-website/supabase/migrations/add_last_login.sql`

#### SQL 실행 방법:
1. [Supabase Dashboard](https://supabase.com/dashboard) 접속
2. 프로젝트 선택
3. 왼쪽 메뉴에서 `SQL Editor` 클릭
4. `New Query` 버튼 클릭
5. `add_last_login.sql` 파일의 내용을 복사해서 붙여넣기
6. `Run` 버튼 클릭 (단축키: Cmd+Enter 또는 Ctrl+Enter)

### 2단계: 웹사이트 실행

```bash
npm run dev
```

### 3단계: 관리자 페이지 접속

1. 웹사이트에서 로그인 (관리자 계정 필요)
2. `/admin` 페이지로 이동
3. **"회원 관리"** 탭 클릭

## 📝 사용 방법

### 회원 검색
- 검색창에 이름 또는 이메일 입력
- 실시간으로 결과 필터링

### 권한 변경
1. 회원 목록에서 변경하고 싶은 회원 찾기
2. "관리" 컬럼의 드롭다운에서 새 권한 선택
3. 확인 대화상자에서 "확인" 클릭

### 엑셀 다운로드
- `엑셀 다운로드` 버튼 클릭
- 현재 필터링된 회원 목록이 Excel 파일로 다운로드됩니다
- 파일명: `회원목록_YYYY-MM-DD.xlsx`

### 필터링
- 드롭다운에서 권한 선택 (모든 권한/관리자/회원/게스트)
- 검색과 필터를 동시에 사용 가능

## 🎨 화면 구성

### 통계 대시보드
- **보라색 카드**: 전체 회원 수
- **빨간색 카드**: 관리자 수
- **파란색 카드**: 회원 수
- **회색 카드**: 게스트 수

### 회원 테이블
| 이름 | 이메일 | 권한 | 가입일 | 마지막 로그인 | 관리 |
|------|--------|------|--------|---------------|------|
| 홍길동 | hong@example.com | 회원 | 2025-01-15 | 2025-11-21 13:00 | [드롭다운] |

## 🔒 권한 체계

- **게스트 (Guest)**: 신규 가입 사용자 기본 권한
- **회원 (Member)**: 승인된 교회 회원
- **관리자 (Admin)**: 모든 관리 기능 사용 가능

## 🚨 주의사항

1. **권한 변경 시 주의**: 관리자 권한 부여는 신중하게 하세요
2. **엑셀 다운로드**: 개인정보가 포함되므로 안전하게 관리하세요
3. **자신의 권한 변경**: 관리자는 자신의 권한을 실수로 변경하지 않도록 주의하세요

## 📊 통계 정보

- 실시간 업데이트
- 검색/필터 적용 시에도 전체 통계 유지
- 페이지 새로고침 시 자동 갱신

## 🆘 문제 해결

### 회원 목록이 안 보여요
1. 데이터베이스 마이그레이션이 완료되었는지 확인
2. 관리자 권한으로 로그인했는지 확인
3. 브라우저 콘솔에서 에러 확인

### 엑셀 다운로드가 안 돼요
- xlsx 라이브러리가 설치되었는지 확인:
  ```bash
  npm list xlsx
  ```
- 없다면 재설치:
  ```bash
  npm install xlsx
  ```

### 마지막 로그인이 "로그인 기록 없음"으로 표시돼요
- 데이터베이스 마이그레이션 후 처음 로그인하는 회원은 이후부터 기록됩니다
- 기존 회원도 다음 로그인 시부터 기록이 업데이트됩니다

## 🎉 완성!

모든 설정이 완료되었습니다. 이제 강력한 회원 관리 시스템을 사용할 수 있습니다!
